# ============================================================
# Smart Testing Tools - 环境配置文件
# ============================================================
# 复制为 .env 后生效（无需在终端手动设置环境变量）
# 注意：不要把真实 key 提交到仓库

# ============================================================
# LLM API 配置
# ============================================================
QT_TEST_AI_LLM_BASE_URL=https://api.deepseek.com
QT_TEST_AI_LLM_MODEL=deepseek-chat
QT_TEST_AI_LLM_API_KEY=sk-efc1e2ed9c864807aca5d5fd6fac9fab
QT_TEST_AI_LLM_TIMEOUT_S=300

# LLM 系统提示词
QT_TEST_AI_LLM_SYSTEM_PROMPT="你是资深 C++/Qt 测试工程师（QtTest/QTest）。你只输出严格 JSON（不要 Markdown、不要解释文字）。输出必须是一个 JSON 对象，包含字段：schema（字符串）、files（数组）、build_hints（字符串）。files 每个元素必须是对象：name（相对路径文件名，.cpp/.h/.hpp 之一）、content（完整源码字符串）。files 至少包含 1 个 .cpp；每个 .cpp 必须包含 <QtTest>，并使用 QObject 测试类 + QTEST_MAIN 或 QTEST_APPLESS_MAIN，确保在 qmake+MinGW 下尽量可编译。请为目标文件编写**全方位的测试用例**，覆盖所有 Public/Protected/Private 方法。为了访问私有成员，请务必在 #include 被测头文件之前使用 '#define private public' 和 '#define protected public' 技巧（并在 include 后 undef）。特别注意：QGraphicsItem 及其子类不是 QObject，不能直接使用 QApplication::sendEvent 或 QTest::mouseClick，也不能使用 QSignalSpy。测试其事件时，请构造事件对象并**直接调用**其事件处理函数（如 item->mousePressEvent(&event)）。对于 UI 渲染（paint），请构造 QImage/QPainter/QStyleOptionGraphicsItem 进行离屏渲染测试。不要臆造未在上下文中出现的类/函数/头文件。涉及 QGraphicsSceneEvent 时，必须显式包含 <QGraphicsSceneMouseEvent>, <QGraphicsSceneHoverEvent>, <QGraphicsSceneContextMenuEvent>，不能依赖 <QGraphicsScene>。"

# ============================================================
# 自动化功能开关
# ============================================================
QT_TEST_AI_ENABLE_AUTOMATION=1

# ============================================================
# Qt/MinGW 工具链路径配置
# ============================================================
QT_BIN_PATH=D:/Qt/6.10.1/mingw_64/bin
MINGW_BIN_PATH=D:/Qt/Tools/mingw1310_64/bin
QT_TEST_AI_GCOV_EXE=D:/Qt/Tools/mingw1310_64/bin/gcov.exe

# ============================================================
# 测试命令配置
# 留空则跳过测试执行阶段，系统会自动运行主程序生成覆盖率数据
# ============================================================
QT_TEST_AI_TEST_CMD=cmd /c "set PATH=D:\Qt\6.10.1\mingw_64\bin;D:\Qt\Tools\mingw1310_64\bin;%PATH% && cd /d C:\Users\lenovo\Desktop\Diagramscene_ultima-syz && cd tests\generated && del Makefile* 2>nul & del *.gcda 2>nul & del *.gcno 2>nul & rmdir /s /q debug 2>nul & rmdir /s /q release 2>nul & D:\Qt\6.10.1\mingw_64\bin\qmake.exe tests.pro -spec win32-g++ && mingw32-make -f Makefile.Debug && debug\tests.exe"
QT_TEST_AI_TEST_TIMEOUT_S=600

# ============================================================
# 覆盖率命令配置
# 重要说明：
#   1. 系统会自动检测 .gcda 文件是否存在
#   2. 如果不存在，会自动运行程序并优雅关闭以生成 .gcda
#   3. --object-directory 指向编译输出目录（通常是 debug）
# ============================================================
QT_TEST_AI_COVERAGE_CMD=cmd /c "cd tests/generated && gcovr -r ../.. debug --gcov-executable D:/Qt/Tools/mingw1310_64/bin/gcov.exe --exclude-directories .git --exclude-directories .venv --exclude-directories build --exclude-directories tests --print-summary --html-details -o ../../coverage.html --json=../../coverage.json"
QT_TEST_AI_COVERAGE_TIMEOUT_S=600

# ============================================================
# 测试生成限制
# ============================================================
QT_TEST_AI_TESTGEN_FILE_LIMIT=50
QT_TEST_AI_TESTGEN_CASE_LIMIT=50
